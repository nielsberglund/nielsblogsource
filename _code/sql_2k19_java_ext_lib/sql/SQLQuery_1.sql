
DROP DATABASE JavaTest;

CREATE DATABASE JavaTest;
GO

EXEC sp_execute_external_script
@language = N'Java',
@script = N'Calculator.adder',
@params = N'@x int, @y int, @CLASSPATH nvarchar(max)',
@x = 21,
@y = 21,
@CLASSPATH = N'W:\javacodepath'


EXEC sp_execute_external_script
@language = N'Java',
@script = N'sqlcalc.Calculator.adder',
@params = N'@x int, @y int, @CLASSPATH nvarchar(max)',
@x = 21,
@y = 21,
@CLASSPATH = N'W:\javacodepath\Calculator-1.0.jar'

-- DROP EXTERNAL LIBRARY Calculator

CREATE EXTERNAL LIBRARY myCalc
FROM (CONTENT = 'W:\javacodepath\Calculator.jar')
WITH (LANGUAGE = 'Java');
GO 


EXEC sp_execute_external_script
@language = N'Java',
@script = N'Calculator.adder',
@params = N'@x int, @y int',
@x = 21,
@y = 21;

CREATE EXTERNAL LIBRARY myCalc
FROM (CONTENT = 'W:\javacodepath\MyCalcJar.jar')
WITH (LANGUAGE = 'Java');
GO 

-- DELETETE 

--DROP EXTERNAL LIBRARY myCalc2

SELECT * FROM sys.external_libraries

SELECT * FROM sys.external_libraries_installed

SELECT * FROM sys.external_library_files

DROP EXTERNAL LIBRARY myCalc

DECLARE @bits nvarchar(max) = '0x504b03040a0008080800a92d644ea66ce1485700000060000000140000004d4554412d494e462f4d414e49464553542e4d46f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5722acdcc29d175aab452c8cb4ccd29e6e5722e4a4d2c494d010b3916242667a42af82696a5e62918eb99c134a4e87aa564830cb0d03388373230e4e5e2e50200504b0708a66ce1485700000060000000504b03040a0000080000a92d644e000000000000000000000000090000004d4554412d494e462f504b03040a0000080000862d644e0000000000000000000000000800000073716c63616c632f504b03040a0000080000a92d644e0000000000000000000000000f0000004d4554412d494e462f6d6176656e2f504b03040a0000080000a92d644e000000000000000000000000170000004d4554412d494e462f6d6176656e2f73716c63616c632f504b03040a0000080000a92d644e000000000000000000000000220000004d4554412d494e462f6d6176656e2f73716c63616c632f43616c63756c61746f722f504b03040a0008080800982d644e752f62866c0100001b0200001800000073716c63616c632f43616c63756c61746f722e636c6173736550cb4ec240143d0303b5b53cac886f011f89bab0312e356e304613840586856c1ca06a49a5585aa39f252c4c8c71e7c68f32de19882e6c72cfe97d9d73335fdf6f1f000eb06540c7aa8e29ac492848284a2869b024af6bd8d0b0c960f5a2fb9613d46e6a51d88fc2b2ef0d18589de289e29ce29921edabe68908050dec33c49ad4498dabd5c8f32e449f21de6c5e31248fdc9e1b1e53babdd360e065bfe330642a6ecfa92aab4bd1f2a86255fcb6f01a2270653e29f2f0ce25ff5c65f0e051b76d9709224f847e70c890109d8e133018753f0adacea92b57327f237b5df1284ccc2267c2c0b4890cb2264ca44ca425ccc022dfffd20c59b9697ba2776bd75a5da71da2448fa4d35b2608498bfe74a9a4383d6192574cbac43130694d3847994dcce4feee2bd88b6ae70993aaa8619ed01c0f60018b4a66e977f90c1cf22bf21162fcdd18213e449c820f91b8ae71fe89646c044dea32a59b271dd0399c8e31e89c3c9d52507acbca7be507504b0708752f62866c0100001b020000504b03040a0008080800c22c644ef6fe303adc0200009d0a0000290000004d4554412d494e462f6d6176656e2f73716c63616c632f43616c63756c61746f722f706f6d2e786d6cc5565b6bdb30147e2ff43f68dec33698ad24dd6809aefb305a2834acb00b7d0b8a7ce2a895254f9273f9f79364c5386db6396d616fce77eee73b4727e9c5bae468094a3329cea361328810082a73268af3e8c7f7abf82cbac88e8f8e8fd24ac97ba0065903a1cfa38531d518e3922c4124a4227401895405befd3ac19f928173e435c76bcd5aedd56a95ac4ebcde683018e2bbc9cd376b589298096d88a0101d1f21644dc6dae3379212e353fb673cf4278db5ce1b30f67a89fd1d652e4c5aca1cf8cfa6f8cc0b53bc83b9c2ad5ea1645d5de799fec529e134c55bc04b89326c4ea8b1bfbf5869cd89912ac51dd8ab852667431765b91b409012768c3de0456fe2185d5ddf4d2e115d10510062061989cc025060e49d462b98696600c57163542b9e755a0e6b52561c122acb143b59086b1d5460d304edcd1ac4b94c6635e379a265ad285c8679c8fc38a4f8af3ac14f43828d57310e2a28d9d24f53bc5fb4dfce105580d96b1744be0ebc53888772a840e476943bc5b5d826201d6aef6bc1cc2eb15ede6131a83ce2d56b2ddb191a0ebbe406b1a636bdcc80b6e6cd77c8083f4aa903746af18d6e19e275c1c48408524009c2647e42b8a40f28972b811ab9deeeb476c3429692e5a8d6962034716d4439cc49cd8d46ef4bb2413340a55c42ee742ba2ac5754c9f2c3769c3a71750b84d1a41c88409ccd816eecf747a401fc26ea7daba8608e69ad5c84b092542ac0adb94e16a6e46fbdd3e9cd16ede6d166d24176690a7e9d8bb851ddcbd90e6f27c9a3ad6c35f09368beecd0bf6ee1f744d9e6d10762d58bf1b3fa10bcc63326dc32856edcfa0ca65b703a976a6a834ddb60cfe98f8266f1f4013d1a24a3be3deac751d8e5035238eb4f53af14746da9600a7aa7304a46a364cf8ebf2007cbe57f24c11f5ece0f68c0e757cec03e795c6e0e48e0ac7f026e57fd657ce517caf97cd903e53c1c40fbe92b0f5d38e296feb9b48f41259539ec29e8b7875ba0bdc1f8c9fd6aeedef6c6b57f2fecf76f504b0708f6fe303adc0200009d0a0000504b03040a0008080800a92d644ed1e2228b5200000055000000300000004d4554412d494e462f6d6176656e2f73716c63616c632f43616c63756c61746f722f706f6d2e70726f7065727469657353762e4a4d2c494d5148aa54702c484cce4855f04d2c4bcd5330d633d333e0e52a4b2d2acecccfb3350471d28bf24b0b3c536c8b0b739213739279b9128b4a32d312934b8062ce4081d29cc492fc225e2e00504b0708d1e2228b5200000055000000504b01021403140008080800a92d644ea66ce1485700000060000000140000000000000000000000a481000000004d4554412d494e462f4d414e49464553542e4d46504b010214030a0000080000a92d644e000000000000000000000000090000000000000000001000ed41990000004d4554412d494e462f504b010214030a0000080000862d644e000000000000000000000000080000000000000000001000ed41c000000073716c63616c632f504b010214030a0000080000a92d644e0000000000000000000000000f0000000000000000001000ed41e60000004d4554412d494e462f6d6176656e2f504b010214030a0000080000a92d644e000000000000000000000000170000000000000000001000ed41130100004d4554412d494e462f6d6176656e2f73716c63616c632f504b010214030a0000080000a92d644e000000000000000000000000220000000000000000001000ed41480100004d4554412d494e462f6d6176656e2f73716c63616c632f43616c63756c61746f722f504b01021403140008080800982d644e752f62866c0100001b020000180000000000000000000000a4818801000073716c63616c632f43616c63756c61746f722e636c617373504b01021403140008080800c22c644ef6fe303adc0200009d0a0000290000000000000000000000a4813a0300004d4554412d494e462f6d6176656e2f73716c63616c632f43616c63756c61746f722f706f6d2e786d6c504b01021403140008080800a92d644ed1e2228b5200000055000000300000000000000000000000a4816d0600004d4554412d494e462f6d6176656e2f73716c63616c632f43616c63756c61746f722f706f6d2e70726f70657274696573504b050600000000090009007c0200001d0700000000';
DECLARE @libName nvarchar(256) = 'myCalc'
DECLARE @sExec nvarchar(max) = 'CREATE EXTERNAL LIBRARY ' + @libName + '  FROM (CONTENT = ' + @bits + ') WITH (LANGUAGE = ''Java'');'
--PRINT @sExec
EXEC (@sExec)
GO 



EXEC sp_execute_external_script
@language = N'Java',
@script = N'Calculator.adder',
@params = N'@x int, @y int, @CLASSPATH nvarchar(max)',
@x = 21,
@y = 21,
@CLASSPATH = N'W:\javacodepath\MyCalcJar.jar'


SELECT el.name, el.[language], ef.content
FROM sys.external_libraries el
JOIN sys.external_library_files ef
  ON el.external_library_id = ef.external_library_id